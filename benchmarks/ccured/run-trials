#!/usr/bin/perl -w

use strict;
use File::Basename;


my $sparsity = shift or die;


foreach my $trial (1 .. 4) {

    my $counts = "../countdowns/$sparsity-$trial.counts";
    unless (-r $counts) {
	my @command = ('make', '-C', dirname($counts), basename($counts));
	print "+@command\n";
	system(@command) == 0
	    or die "cannot build counts: $?: $!\n";
    }

    my $command = "env SAMPLER_EVENT_COUNTDOWNS=$counts /usr/bin/time @ARGV";
    print "+$command\n";
    system($command) == 0
	or die "command failed: $?: $!\n";
}
